<style>
.share-card {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    background: #f9f9f9;
}
</style>

<div style="display: flex; flex-direction: column; gap: 20px; margin: 30px 30px 0px 300px;">
     <h2>{{ share.company_name }} ({{ share.share_group_name }})</h2>
    {% for account in accounts %}
        <div class="share-card">
           
            <p><strong>Account Name:</strong> {{ account.name }}</p>
            <p><strong>Demat Number:</strong> {{ account.get_demat }}</p>
            <p><strong>Applied Kitta:</strong> 10 </p>
            <div>
                <button 
                    id="applyBtn-{{ account.id }}" 
                    class="applyBtn" 
                    data-user-id="{{ account.id }}" 
                    data-share-id="{{ share.id }}" 
                    disabled>
                    Loading...
                </button>
            </div>
        </div>
    {% empty %}
        <p>No shares available.</p>
    {% endfor %}
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function () {
    $(".applyBtn").each(function () {
        let button = $(this);
        let userId = button.data("user-id");
        let shareId = button.data("share-id");
        console.log(`Checking status for User ID: ${userId}, Share ID: ${shareId}`);
        $.ajax({
            url: `/apply/check-status/${userId}/${shareId}/`,
            type: "GET",
            dataType: "json",
            success: function (data) {
                if (data.status === "True") {
                    button.prop("disabled", false).text("Apply Now ");
                } else {
                    button.prop("disabled", true).text("Applied ");
                }
            },
            error: function () {
                button.prop("disabled", true).text("Error ");
            }
        });
    });
});
</script>
